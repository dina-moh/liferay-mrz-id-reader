{"ast":null,"code":"import React,{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import Tesseract from\"tesseract.js\";import Dropzone from\"react-dropzone\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const dropzoneStyle={border:\"2px dashed var(--primary)\",borderRadius:\"4px\",padding:\"20px\",textAlign:\"center\",cursor:\"pointer\"};const imageStyle={marginTop:\"20px\",maxWidth:\"100%\"};const btnColor={backgroundColor:\"var(--secondary)\",color:\"var(--light)\"};export default function IdReader(){const[uploadedImage,setUploadedImage]=useState(null);const[isLoading,setIsLoading]=useState(false);const[idNumber,setIdNumber]=useState(null);const[name,setName]=useState(\"\");const[cusType,setCusType]=useState(null);const navigate=useNavigate();// Using useNavigate\nfunction handleImageUpload(acceptedFiles){setIsLoading(true);const imageFile=acceptedFiles[0];setUploadedImage(URL.createObjectURL(imageFile));Tesseract.recognize(imageFile,\"eng\",{logger:info=>console.log(info)}).then(_ref=>{let{data:{text}}=_ref;const lines=text.split(\"\\n\");// Extract ID number from the fourth-to-last line\nconst idLine=lines[lines.length-4];const idNumberMatch=idLine.match(/\\d+/);// Match all consecutive numbers\nif(idNumberMatch){const extractedIdNumber=idNumberMatch[0];setIdNumber(extractedIdNumber);}// Extract full name from the last line and replace \"<\" with \" \"\nconst lastLine=lines[lines.length-2];const cleanedFullName=lastLine.replace(/<+/g,\" \").trim();console.log(\"Cleaned Name\"+cleanedFullName);setName(cleanedFullName);setIsLoading(false);});}function handleCusTypeChange(e){setCusType(e.target.value);}function handleGenerateQRCode(){navigate(\"/qrcode\",{state:{idNumber,name,cusType}});}return/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{borderRadius:\"15px\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body p-5\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-uppercase text-center mb-5\",children:\"Demo Service Request\"}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-outline mb-4\",children:/*#__PURE__*/_jsx(Dropzone,{onDrop:handleImageUpload,accept:\"image/*\",children:_ref2=>{let{getRootProps,getInputProps}=_ref2;return/*#__PURE__*/_jsxs(\"div\",{...getRootProps(),style:dropzoneStyle,children:[/*#__PURE__*/_jsx(\"input\",{...getInputProps()}),/*#__PURE__*/_jsx(\"p\",{children:\"Drag & drop an ID photo here, or click to select one\"})]});}})}),uploadedImage&&/*#__PURE__*/_jsx(\"div\",{className:\"form-outline mb-4\",children:/*#__PURE__*/_jsx(\"img\",{src:uploadedImage,alt:\"Uploaded ID\",style:imageStyle})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline mb-4\",children:[isLoading&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Reading ID Card...\"})}),!isLoading&&idNumber&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",htmlFor:\"\",children:\"Civil ID\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-md\",value:idNumber,placeholder:\"Civil ID captured form photo ID\",disabled:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",htmlFor:\"\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-md\",value:name,placeholder:\"Full Name captured form photo ID\",disabled:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",htmlFor:\"form3Example4cdg\",children:\"Customer Type\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"\",className:\"form-control form-control-md\",value:cusType,onChange:handleCusTypeChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"Type 1\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"Type 2\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"Type 3\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-block btn-lg gradient-custom-4 text-body\",style:btnColor,onClick:handleGenerateQRCode,children:\"Register\"})})]})]})]})]})});}","map":{"version":3,"names":["React","useState","useNavigate","Tesseract","Dropzone","jsx","_jsx","jsxs","_jsxs","dropzoneStyle","border","borderRadius","padding","textAlign","cursor","imageStyle","marginTop","maxWidth","btnColor","backgroundColor","color","IdReader","uploadedImage","setUploadedImage","isLoading","setIsLoading","idNumber","setIdNumber","name","setName","cusType","setCusType","navigate","handleImageUpload","acceptedFiles","imageFile","URL","createObjectURL","recognize","logger","info","console","log","then","_ref","data","text","lines","split","idLine","length","idNumberMatch","match","extractedIdNumber","lastLine","cleanedFullName","replace","trim","handleCusTypeChange","e","target","value","handleGenerateQRCode","state","className","style","children","onDrop","accept","_ref2","getRootProps","getInputProps","src","alt","htmlFor","type","placeholder","disabled","id","onChange","onClick"],"sources":["/Users/mahmoudtayem/Documents/dina/liferay-utils/client-extensions/liferay-mrz-document-reader/src/IdReader.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Tesseract from \"tesseract.js\";\nimport Dropzone from \"react-dropzone\";\n\nconst dropzoneStyle = {\n  border: `2px dashed var(--primary)`,\n  borderRadius: \"4px\",\n  padding: \"20px\",\n  textAlign: \"center\",\n  cursor: \"pointer\",\n};\n\nconst imageStyle = {\n  marginTop: \"20px\",\n  maxWidth: \"100%\",\n};\n\nconst btnColor = {\n  backgroundColor: `var(--secondary)`,\n  color: `var(--light)`,\n};\n\n\n\n\nexport default function IdReader() {\n  const [uploadedImage, setUploadedImage] = useState(null);\n  const [isLoading,setIsLoading]  = useState(false);\n  const [idNumber, setIdNumber] = useState(null);\n  const [name, setName] = useState(\"\");\n  const [cusType, setCusType] = useState(null);\n  const navigate = useNavigate(); // Using useNavigate\n\n  function handleImageUpload(acceptedFiles) {\n    setIsLoading(true);\n    const imageFile = acceptedFiles[0];\n    setUploadedImage(URL.createObjectURL(imageFile));\n\n    Tesseract.recognize(imageFile, \"eng\", {\n      logger: (info) => console.log(info),\n    }).then(({ data: { text } }) => {\n      const lines = text.split(\"\\n\");\n\n      // Extract ID number from the fourth-to-last line\n      const idLine = lines[lines.length - 4];\n      const idNumberMatch = idLine.match(/\\d+/); // Match all consecutive numbers\n      if (idNumberMatch) {\n        const extractedIdNumber = idNumberMatch[0];\n        setIdNumber((extractedIdNumber));\n      }\n\n      // Extract full name from the last line and replace \"<\" with \" \"\n      const lastLine = lines[lines.length - 2];\n      const cleanedFullName = lastLine.replace(/<+/g, \" \").trim();\n\n      console.log(\"Cleaned Name\" + cleanedFullName);\n      setName(cleanedFullName);\n      setIsLoading(false);\n    });\n  }\n\n  function handleCusTypeChange(e) {\n    setCusType(e.target.value);\n  }\n\n  function handleGenerateQRCode() {\n\n    navigate(\"/qrcode\", { state: { idNumber, name, cusType } });\n  }\n\n  return (\n      <div className=\"card\" style={{ borderRadius: \"15px\" }}>\n        <div className=\"card-body p-5\">\n\n          <h2 className=\"text-uppercase text-center mb-5\">\n            Demo Service Request\n          </h2>\n\n          <form>\n\n            <div className=\"form-outline mb-4\">\n\n              <Dropzone onDrop={handleImageUpload} accept=\"image/*\">\n                {({ getRootProps, getInputProps }) => (\n                    <div {...getRootProps()} style={dropzoneStyle}>\n                      <input {...getInputProps()} />\n                      <p>\n                        Drag & drop an ID photo here, or click to select\n                        one\n                      </p>\n                    </div>\n                )}\n              </Dropzone>\n\n            </div>\n\n            {uploadedImage && (\n                <div className=\"form-outline mb-4\">\n\n                  <img\n                      src={uploadedImage}\n                      alt=\"Uploaded ID\"\n                      style={imageStyle}\n                  />\n\n                </div>\n            )}\n\n            <div className=\"form-outline mb-4\">\n              {isLoading && (<div><strong>Reading ID Card...</strong></div>)}\n              {!isLoading && idNumber && (\n                  <div>\n                    <label className=\"form-label\" htmlFor=\"\">\n                      Civil ID\n                    </label>\n                    <input\n                        type=\"text\"\n                        className=\"form-control form-control-md\"\n                        value={idNumber}\n                        placeholder=\"Civil ID captured form photo ID\"\n                        disabled\n                    />\n                    <div className=\"form-outline mb-4\">\n\n                      <label className=\"form-label\" htmlFor=\"\">\n                        Full Name\n                      </label>\n\n                      <input\n                          type=\"text\"\n                          className=\"form-control form-control-md\"\n                          value={name}\n                          placeholder=\"Full Name captured form photo ID\"\n                          disabled\n                      />\n\n                    </div>\n                    <div className=\"form-outline mb-4\">\n\n                      <label className=\"form-label\" htmlFor=\"form3Example4cdg\">\n                        Customer Type\n                      </label>\n\n                      <select id=\"\" className=\"form-control form-control-md\" value={cusType}\n                              onChange={handleCusTypeChange}>\n                        <option value=\"1\">Type 1</option>\n                        <option value=\"2\">Type 2</option>\n                        <option value=\"3\">Type 3</option>\n\n                      </select>\n\n                    </div>\n                    <div className=\"d-flex justify-content-center\">\n\n                      <button\n                          type=\"button\"\n                          className=\"btn btn-block btn-lg gradient-custom-4 text-body\"\n                          style={btnColor}\n                          onClick={handleGenerateQRCode}\n                      >\n                        Register\n                      </button>\n\n                    </div>\n                  </div>\n              )}\n            </div>\n          </form>\n        </div>\n\n      </div>\n  );\n}\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}