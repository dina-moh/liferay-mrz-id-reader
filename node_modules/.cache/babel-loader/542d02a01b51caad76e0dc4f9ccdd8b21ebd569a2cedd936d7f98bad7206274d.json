{"ast":null,"code":"import React,{useState}from\"react\";import{useNavigate}from\"react-router-dom\";import Tesseract from\"tesseract.js\";import Dropzone from\"react-dropzone\";import QRCode from\"qrcode.react\";import QrCodePage from\"./QrCodePage\";import{postRequest}from\"./services/serviceRequest\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const dropzoneStyle={border:\"2px dashed var(--primary)\",borderRadius:\"4px\",padding:\"20px\",textAlign:\"center\",cursor:\"pointer\"};const imageStyle={marginTop:\"20px\",maxWidth:\"100%\"};const btnColor={backgroundColor:\"var(--secondary)\",color:\"var(--light)\"};export default function IdReader(){const[uploadedImage,setUploadedImage]=useState(null);const[isLoading,setIsLoading]=useState(false);const[idNumber,setIdNumber]=useState(null);const[name,setName]=useState(\"\");const[cusType,setCusType]=useState(null);const[showQRCode,setShowQRCode]=useState(false);function handleImageUpload(acceptedFiles){setIsLoading(true);const imageFile=acceptedFiles[0];setUploadedImage(URL.createObjectURL(imageFile));Tesseract.recognize(imageFile,\"eng\",{logger:info=>console.log(info)}).then(_ref=>{let{data:{text}}=_ref;const lines=text.split(\"\\n\");// Extract ID number from the fourth-to-last line\nconst idLine=lines[lines.length-4];const idNumberMatch=idLine.match(/\\d+/);// Match all consecutive numbers\nif(idNumberMatch){const extractedIdNumber=idNumberMatch[0];setIdNumber(extractedIdNumber);}// Extract full name from the last line and replace \"<\" with \" \"\nconst lastLine=lines[lines.length-2];const cleanedFullName=lastLine.replace(/<+/g,\" \").trim();console.log(\"Cleaned Name\"+cleanedFullName);setName(cleanedFullName);setIsLoading(false);});}function handleCusTypeChange(e){setCusType(e.target.value);}function handleCreateNewObject(){let newDemoRequestData={\"civilID\":idNumber,\"customerType\":cusType,\"fullName\":name};postRequest(newDemoRequestData);console.log(\"Reached here : \"+newDemoRequestData);}function handleGenerateQRCode(){handleCreateNewObject();setShowQRCode(true);}return/*#__PURE__*/_jsxs(_Fragment,{children:[!showQRCode&&/*#__PURE__*/_jsx(\"div\",{className:\"card\",style:{borderRadius:\"15px\"},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body p-5\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-uppercase text-center mb-5\",children:\"Demo Service Request\"}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-outline mb-4\",children:/*#__PURE__*/_jsx(Dropzone,{onDrop:handleImageUpload,accept:\"image/*\",children:_ref2=>{let{getRootProps,getInputProps}=_ref2;return/*#__PURE__*/_jsxs(\"div\",{...getRootProps(),style:dropzoneStyle,children:[/*#__PURE__*/_jsx(\"input\",{...getInputProps()}),/*#__PURE__*/_jsx(\"p\",{children:\"Drag & drop an ID photo here, or click to select one\"})]});}})}),uploadedImage&&/*#__PURE__*/_jsx(\"div\",{className:\"form-outline mb-4\",children:/*#__PURE__*/_jsx(\"img\",{src:uploadedImage,alt:\"Uploaded ID\",style:imageStyle})}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline mb-4\",children:[isLoading&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\"Reading ID Card...\"})}),!isLoading&&idNumber&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",htmlFor:\"\",children:\"Civil ID\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-md\",value:idNumber,placeholder:\"Civil ID captured form photo ID\",disabled:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",htmlFor:\"\",children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-md\",value:name,placeholder:\"Full Name captured form photo ID\",disabled:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-outline mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",htmlFor:\"form3Example4cdg\",children:\"Customer Type\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"\",className:\"form-control form-control-md\",value:cusType,onChange:handleCusTypeChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"Type 1\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"Type 2\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"Type 3\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-block btn-lg gradient-custom-4 text-body\",style:btnColor,onClick:handleGenerateQRCode,children:\"Register\"})})]})]})]})]})}),showQRCode&&/*#__PURE__*/_jsx(QrCodePage,{cusType:cusType,name:name,idNumber:idNumber})]});}","map":{"version":3,"names":["React","useState","useNavigate","Tesseract","Dropzone","QRCode","QrCodePage","postRequest","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","dropzoneStyle","border","borderRadius","padding","textAlign","cursor","imageStyle","marginTop","maxWidth","btnColor","backgroundColor","color","IdReader","uploadedImage","setUploadedImage","isLoading","setIsLoading","idNumber","setIdNumber","name","setName","cusType","setCusType","showQRCode","setShowQRCode","handleImageUpload","acceptedFiles","imageFile","URL","createObjectURL","recognize","logger","info","console","log","then","_ref","data","text","lines","split","idLine","length","idNumberMatch","match","extractedIdNumber","lastLine","cleanedFullName","replace","trim","handleCusTypeChange","e","target","value","handleCreateNewObject","newDemoRequestData","handleGenerateQRCode","children","className","style","onDrop","accept","_ref2","getRootProps","getInputProps","src","alt","htmlFor","type","placeholder","disabled","id","onChange","onClick"],"sources":["/Users/dinamakled/Documents/Liferay/Workspaces/liferay-utils/client-extensions/liferay-mrz-document-reader/src/IdReader.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport Tesseract from \"tesseract.js\";\nimport Dropzone from \"react-dropzone\";\nimport QRCode from \"qrcode.react\";\nimport QrCodePage from \"./QrCodePage\";\nimport { postRequest } from \"./services/serviceRequest\"; \n\nconst dropzoneStyle = {\n  border: `2px dashed var(--primary)`,\n  borderRadius: \"4px\",\n  padding: \"20px\",\n  textAlign: \"center\",\n  cursor: \"pointer\",\n};\n\nconst imageStyle = {\n  marginTop: \"20px\",\n  maxWidth: \"100%\",\n};\n\nconst btnColor = {\n  backgroundColor: `var(--secondary)`,\n  color: `var(--light)`,\n};\n\n\n\n\nexport default function IdReader() {\n  const [uploadedImage, setUploadedImage] = useState(null);\n  const [isLoading,setIsLoading]  = useState(false);\n  const [idNumber, setIdNumber] = useState(null);\n  const [name, setName] = useState(\"\");\n  const [cusType, setCusType] = useState(null);\n\n  const [showQRCode,setShowQRCode] = useState(false);\n\n  function handleImageUpload(acceptedFiles) {\n    setIsLoading(true);\n    const imageFile = acceptedFiles[0];\n    setUploadedImage(URL.createObjectURL(imageFile));\n\n    Tesseract.recognize(imageFile, \"eng\", {\n      logger: (info) => console.log(info),\n    }).then(({ data: { text } }) => {\n      const lines = text.split(\"\\n\");\n\n      // Extract ID number from the fourth-to-last line\n      const idLine = lines[lines.length - 4];\n      const idNumberMatch = idLine.match(/\\d+/); // Match all consecutive numbers\n      if (idNumberMatch) {\n        const extractedIdNumber = idNumberMatch[0];\n        setIdNumber((extractedIdNumber));\n      }\n\n      // Extract full name from the last line and replace \"<\" with \" \"\n      const lastLine = lines[lines.length - 2];\n      const cleanedFullName = lastLine.replace(/<+/g, \" \").trim();\n\n      console.log(\"Cleaned Name\" + cleanedFullName);\n      setName(cleanedFullName);\n      setIsLoading(false);\n    });\n  }\n\n  function handleCusTypeChange(e) {\n    setCusType(e.target.value);\n  }\n\n  function handleCreateNewObject() {\n    let newDemoRequestData = {\n      \"civilID\": idNumber,\n      \"customerType\": cusType,\n      \"fullName\": name\n    }\n\n    postRequest(newDemoRequestData);\n    console.log(\"Reached here : \" + newDemoRequestData)\n  }\n\n  function handleGenerateQRCode() {\n    handleCreateNewObject();\n    setShowQRCode(true);\n  }\n\n  return (\n     <>\n       {!showQRCode && (\n           <div className=\"card\" style={{ borderRadius: \"15px\" }}>\n             <div className=\"card-body p-5\">\n\n               <h2 className=\"text-uppercase text-center mb-5\">\n                 Demo Service Request\n               </h2>\n\n               <form>\n\n                 <div className=\"form-outline mb-4\">\n\n                   <Dropzone onDrop={handleImageUpload} accept=\"image/*\">\n                     {({ getRootProps, getInputProps }) => (\n                         <div {...getRootProps()} style={dropzoneStyle}>\n                           <input {...getInputProps()} />\n                           <p>\n                             Drag & drop an ID photo here, or click to select\n                             one\n                           </p>\n                         </div>\n                     )}\n                   </Dropzone>\n\n                 </div>\n\n                 {uploadedImage && (\n                     <div className=\"form-outline mb-4\">\n\n                       <img\n                           src={uploadedImage}\n                           alt=\"Uploaded ID\"\n                           style={imageStyle}\n                       />\n\n                     </div>\n                 )}\n\n                 <div className=\"form-outline mb-4\">\n                   {isLoading && (<div><strong>Reading ID Card...</strong></div>)}\n                   {!isLoading && idNumber && (\n                       <div>\n                         <label className=\"form-label\" htmlFor=\"\">\n                           Civil ID\n                         </label>\n                         <input\n                             type=\"text\"\n                             className=\"form-control form-control-md\"\n                             value={idNumber}\n                             placeholder=\"Civil ID captured form photo ID\"\n                             disabled\n                         />\n                         <div className=\"form-outline mb-4\">\n\n                           <label className=\"form-label\" htmlFor=\"\">\n                             Full Name\n                           </label>\n\n                           <input\n                               type=\"text\"\n                               className=\"form-control form-control-md\"\n                               value={name}\n                               placeholder=\"Full Name captured form photo ID\"\n                               disabled\n                           />\n\n                         </div>\n                         <div className=\"form-outline mb-4\">\n\n                           <label className=\"form-label\" htmlFor=\"form3Example4cdg\">\n                             Customer Type\n                           </label>\n\n                           <select id=\"\" className=\"form-control form-control-md\" value={cusType}\n                                   onChange={handleCusTypeChange}>\n                             <option value=\"1\">Type 1</option>\n                             <option value=\"2\">Type 2</option>\n                             <option value=\"3\">Type 3</option>\n\n                           </select>\n\n                         </div>\n                         <div className=\"d-flex justify-content-center\">\n\n                           <button\n                               type=\"button\"\n                               className=\"btn btn-block btn-lg gradient-custom-4 text-body\"\n                               style={btnColor}\n                               onClick={handleGenerateQRCode}\n                           >\n                             Register\n                           </button>\n\n                         </div>\n                       </div>\n                   )}\n                 </div>\n               </form>\n             </div>\n\n           </div>\n       )}\n       {showQRCode && (\n           <QrCodePage cusType={cusType} name={name} idNumber={idNumber}></QrCodePage>\n       )}\n     </>\n  );\n}\n\n\n\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,SAAS,KAAM,cAAc,CACpC,MAAO,CAAAC,QAAQ,KAAM,gBAAgB,CACrC,MAAO,CAAAC,MAAM,KAAM,cAAc,CACjC,MAAO,CAAAC,UAAU,KAAM,cAAc,CACrC,OAASC,WAAW,KAAQ,2BAA2B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAExD,KAAM,CAAAC,aAAa,CAAG,CACpBC,MAAM,4BAA6B,CACnCC,YAAY,CAAE,KAAK,CACnBC,OAAO,CAAE,MAAM,CACfC,SAAS,CAAE,QAAQ,CACnBC,MAAM,CAAE,SACV,CAAC,CAED,KAAM,CAAAC,UAAU,CAAG,CACjBC,SAAS,CAAE,MAAM,CACjBC,QAAQ,CAAE,MACZ,CAAC,CAED,KAAM,CAAAC,QAAQ,CAAG,CACfC,eAAe,mBAAoB,CACnCC,KAAK,eACP,CAAC,CAKD,cAAe,SAAS,CAAAC,QAAQA,CAAA,CAAG,CACjC,KAAM,CAACC,aAAa,CAAEC,gBAAgB,CAAC,CAAG3B,QAAQ,CAAC,IAAI,CAAC,CACxD,KAAM,CAAC4B,SAAS,CAACC,YAAY,CAAC,CAAI7B,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAAC8B,QAAQ,CAAEC,WAAW,CAAC,CAAG/B,QAAQ,CAAC,IAAI,CAAC,CAC9C,KAAM,CAACgC,IAAI,CAAEC,OAAO,CAAC,CAAGjC,QAAQ,CAAC,EAAE,CAAC,CACpC,KAAM,CAACkC,OAAO,CAAEC,UAAU,CAAC,CAAGnC,QAAQ,CAAC,IAAI,CAAC,CAE5C,KAAM,CAACoC,UAAU,CAACC,aAAa,CAAC,CAAGrC,QAAQ,CAAC,KAAK,CAAC,CAElD,QAAS,CAAAsC,iBAAiBA,CAACC,aAAa,CAAE,CACxCV,YAAY,CAAC,IAAI,CAAC,CAClB,KAAM,CAAAW,SAAS,CAAGD,aAAa,CAAC,CAAC,CAAC,CAClCZ,gBAAgB,CAACc,GAAG,CAACC,eAAe,CAACF,SAAS,CAAC,CAAC,CAEhDtC,SAAS,CAACyC,SAAS,CAACH,SAAS,CAAE,KAAK,CAAE,CACpCI,MAAM,CAAGC,IAAI,EAAKC,OAAO,CAACC,GAAG,CAACF,IAAI,CACpC,CAAC,CAAC,CAACG,IAAI,CAACC,IAAA,EAAwB,IAAvB,CAAEC,IAAI,CAAE,CAAEC,IAAK,CAAE,CAAC,CAAAF,IAAA,CACzB,KAAM,CAAAG,KAAK,CAAGD,IAAI,CAACE,KAAK,CAAC,IAAI,CAAC,CAE9B;AACA,KAAM,CAAAC,MAAM,CAAGF,KAAK,CAACA,KAAK,CAACG,MAAM,CAAG,CAAC,CAAC,CACtC,KAAM,CAAAC,aAAa,CAAGF,MAAM,CAACG,KAAK,CAAC,KAAK,CAAC,CAAE;AAC3C,GAAID,aAAa,CAAE,CACjB,KAAM,CAAAE,iBAAiB,CAAGF,aAAa,CAAC,CAAC,CAAC,CAC1CzB,WAAW,CAAE2B,iBAAkB,CAAC,CAClC,CAEA;AACA,KAAM,CAAAC,QAAQ,CAAGP,KAAK,CAACA,KAAK,CAACG,MAAM,CAAG,CAAC,CAAC,CACxC,KAAM,CAAAK,eAAe,CAAGD,QAAQ,CAACE,OAAO,CAAC,KAAK,CAAE,GAAG,CAAC,CAACC,IAAI,CAAC,CAAC,CAE3DhB,OAAO,CAACC,GAAG,CAAC,cAAc,CAAGa,eAAe,CAAC,CAC7C3B,OAAO,CAAC2B,eAAe,CAAC,CACxB/B,YAAY,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CACJ,CAEA,QAAS,CAAAkC,mBAAmBA,CAACC,CAAC,CAAE,CAC9B7B,UAAU,CAAC6B,CAAC,CAACC,MAAM,CAACC,KAAK,CAAC,CAC5B,CAEA,QAAS,CAAAC,qBAAqBA,CAAA,CAAG,CAC/B,GAAI,CAAAC,kBAAkB,CAAG,CACvB,SAAS,CAAEtC,QAAQ,CACnB,cAAc,CAAEI,OAAO,CACvB,UAAU,CAAEF,IACd,CAAC,CAED1B,WAAW,CAAC8D,kBAAkB,CAAC,CAC/BtB,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAGqB,kBAAkB,CAAC,CACrD,CAEA,QAAS,CAAAC,oBAAoBA,CAAA,CAAG,CAC9BF,qBAAqB,CAAC,CAAC,CACvB9B,aAAa,CAAC,IAAI,CAAC,CACrB,CAEA,mBACG3B,KAAA,CAAAE,SAAA,EAAA0D,QAAA,EACG,CAAClC,UAAU,eACR5B,IAAA,QAAK+D,SAAS,CAAC,MAAM,CAACC,KAAK,CAAE,CAAEzD,YAAY,CAAE,MAAO,CAAE,CAAAuD,QAAA,cACpD5D,KAAA,QAAK6D,SAAS,CAAC,eAAe,CAAAD,QAAA,eAE5B9D,IAAA,OAAI+D,SAAS,CAAC,iCAAiC,CAAAD,QAAA,CAAC,sBAEhD,CAAI,CAAC,cAEL5D,KAAA,SAAA4D,QAAA,eAEE9D,IAAA,QAAK+D,SAAS,CAAC,mBAAmB,CAAAD,QAAA,cAEhC9D,IAAA,CAACL,QAAQ,EAACsE,MAAM,CAAEnC,iBAAkB,CAACoC,MAAM,CAAC,SAAS,CAAAJ,QAAA,CAClDK,KAAA,MAAC,CAAEC,YAAY,CAAEC,aAAc,CAAC,CAAAF,KAAA,oBAC7BjE,KAAA,WAASkE,YAAY,CAAC,CAAC,CAAEJ,KAAK,CAAE3D,aAAc,CAAAyD,QAAA,eAC5C9D,IAAA,aAAWqE,aAAa,CAAC,CAAC,CAAG,CAAC,cAC9BrE,IAAA,MAAA8D,QAAA,CAAG,sDAGH,CAAG,CAAC,EACD,CAAC,EACT,CACO,CAAC,CAER,CAAC,CAEL5C,aAAa,eACVlB,IAAA,QAAK+D,SAAS,CAAC,mBAAmB,CAAAD,QAAA,cAEhC9D,IAAA,QACIsE,GAAG,CAAEpD,aAAc,CACnBqD,GAAG,CAAC,aAAa,CACjBP,KAAK,CAAErD,UAAW,CACrB,CAAC,CAEC,CACR,cAEDT,KAAA,QAAK6D,SAAS,CAAC,mBAAmB,CAAAD,QAAA,EAC/B1C,SAAS,eAAKpB,IAAA,QAAA8D,QAAA,cAAK9D,IAAA,WAAA8D,QAAA,CAAQ,oBAAkB,CAAQ,CAAC,CAAK,CAAE,CAC7D,CAAC1C,SAAS,EAAIE,QAAQ,eACnBpB,KAAA,QAAA4D,QAAA,eACE9D,IAAA,UAAO+D,SAAS,CAAC,YAAY,CAACS,OAAO,CAAC,EAAE,CAAAV,QAAA,CAAC,UAEzC,CAAO,CAAC,cACR9D,IAAA,UACIyE,IAAI,CAAC,MAAM,CACXV,SAAS,CAAC,8BAA8B,CACxCL,KAAK,CAAEpC,QAAS,CAChBoD,WAAW,CAAC,iCAAiC,CAC7CC,QAAQ,MACX,CAAC,cACFzE,KAAA,QAAK6D,SAAS,CAAC,mBAAmB,CAAAD,QAAA,eAEhC9D,IAAA,UAAO+D,SAAS,CAAC,YAAY,CAACS,OAAO,CAAC,EAAE,CAAAV,QAAA,CAAC,WAEzC,CAAO,CAAC,cAER9D,IAAA,UACIyE,IAAI,CAAC,MAAM,CACXV,SAAS,CAAC,8BAA8B,CACxCL,KAAK,CAAElC,IAAK,CACZkD,WAAW,CAAC,kCAAkC,CAC9CC,QAAQ,MACX,CAAC,EAEC,CAAC,cACNzE,KAAA,QAAK6D,SAAS,CAAC,mBAAmB,CAAAD,QAAA,eAEhC9D,IAAA,UAAO+D,SAAS,CAAC,YAAY,CAACS,OAAO,CAAC,kBAAkB,CAAAV,QAAA,CAAC,eAEzD,CAAO,CAAC,cAER5D,KAAA,WAAQ0E,EAAE,CAAC,EAAE,CAACb,SAAS,CAAC,8BAA8B,CAACL,KAAK,CAAEhC,OAAQ,CAC9DmD,QAAQ,CAAEtB,mBAAoB,CAAAO,QAAA,eACpC9D,IAAA,WAAQ0D,KAAK,CAAC,GAAG,CAAAI,QAAA,CAAC,QAAM,CAAQ,CAAC,cACjC9D,IAAA,WAAQ0D,KAAK,CAAC,GAAG,CAAAI,QAAA,CAAC,QAAM,CAAQ,CAAC,cACjC9D,IAAA,WAAQ0D,KAAK,CAAC,GAAG,CAAAI,QAAA,CAAC,QAAM,CAAQ,CAAC,EAE3B,CAAC,EAEN,CAAC,cACN9D,IAAA,QAAK+D,SAAS,CAAC,+BAA+B,CAAAD,QAAA,cAE5C9D,IAAA,WACIyE,IAAI,CAAC,QAAQ,CACbV,SAAS,CAAC,kDAAkD,CAC5DC,KAAK,CAAElD,QAAS,CAChBgE,OAAO,CAAEjB,oBAAqB,CAAAC,QAAA,CACjC,UAED,CAAQ,CAAC,CAEN,CAAC,EACH,CACR,EACE,CAAC,EACF,CAAC,EACJ,CAAC,CAEH,CACR,CACAlC,UAAU,eACP5B,IAAA,CAACH,UAAU,EAAC6B,OAAO,CAAEA,OAAQ,CAACF,IAAI,CAAEA,IAAK,CAACF,QAAQ,CAAEA,QAAS,CAAa,CAC7E,EACD,CAAC,CAER"},"metadata":{},"sourceType":"module","externalDependencies":[]}